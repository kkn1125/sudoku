var Y=Object.defineProperty;var K=(f,t,e)=>t in f?Y(f,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):f[t]=e;var p=(f,t,e)=>(K(f,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function e(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(s){if(s.ep)return;s.ep=!0;const i=e(s);fetch(s.href,i)}})();const E=3,L=3,v=3,k=3,u=50,r=50,n={tile:null,selectTile:null,selected:null,deletion:!1},x=[1,2,3,4,5,6,7,8,9],U="#00772250",M="#84112270",G="#77777756",j="#84253240",X="#84253230",q="#00000070",N="#000000",Z="#009922",V="#777777",y=16,J=.06,g={number:null,place:null},d={number:null,place:null,count:0},A=3,W=new Map([[1,9],[2,9],[3,9],[4,9],[5,9],[6,9],[7,9],[8,9],[9,9]]),F=1,H=.8,D=.6,I=new Map(W.entries()),Q=f=>document.querySelector(f),ee=Q("#app"),h=document.createElement("canvas"),o=h.getContext("2d");class T{constructor(t=0,e=!1,l=!1){p(this,"staticNum",0);p(this,"number",0);p(this,"origin",!1);p(this,"memo",[]);p(this,"hide",!1);this.staticNum=t,this.number=t,this.origin=e,this.hide=l}copy(t){return this.number=t.number,this.origin=t.origin,this.memo=t.memo.slice(0),this}setNumber(t){this.number=t}deleteNumber(){this.number=0}setHide(){this.hide=!0}setShow(){this.hide=!1}setMemo(t){this.memo.includes(t)||this.memo.push(t)}deleteMemo(t){try{return this.memo.splice(this.memo.findIndex(t),1),!0}catch{return console.log("존재하지 않는 수 입니다.",t),!1}}}class O{constructor(...t){p(this,"tiles",[]);this.tiles.push(...t.map(e=>e instanceof T?e:new T(e,e!==0)))}getColumns(t){}isFitNumber(t){return this.tiles.findIndex(e=>e.number===t)===-1}deepCopy(){return this.tiles.map(t=>new T().copy(t))}}class te{render(t){const e=h.width>=768?F:h.width<768&&h.width>=594?H:D;try{const l=x.sort(),s=h.width/2-t.rows.length/2*u*e,i=h.height/2-t.rows[0].tiles.length/2*r*e,c=s+u*e*E*v,b=i+r*e*L*k,a=h.width*.06;o.fillStyle=M,o.fillRect(c+a-u*e,i,u*e,r*e),o.fillStyle=N,o.textAlign="center",o.font=`${y}px bold`,o.fillText("❌",c+a-u*e+u*e/2,i+r*e/2+y/3),o.font=`${y-6}px bold`,o.fillStyle=N;for(let m in l){const w=l[m];I.get(w)===0&&(o.fillStyle=q,o.fillRect(c+a,i+r*e*m,u*e,r*e),o.fillStyle=N),o.strokeRect(c+a,i+r*e*m,u*e,r*e),o.textAlign="center",o.font=`${y}px bold`,o.fillText(w,u*e/2+c+a,r*e/2+i+y/3+r*e*m),o.font=`${y-6}px bold`,o.fillText(I.get(w)+"개 남음",u*e/2+c+a+u*e*1.3,r*e/2+i+y/3+r*e*m),o.font=`${y}px bold`}}catch(l){console.log(l)}}}class le{render(t){h.width/2-t.rows.length/2*u,h.height/2-t.rows[0].tiles.length/2*r;const e=`${d.count}/${A}`,l=20,s=45;o.strokeRect(h.width/2-e.length*y/2-l/2,s-y-l/3,e.length*y+l,y+l),o.fillText(e,h.width/2,s)}}class R{constructor(...t){p(this,"rows",[]);p(this,"numberPad",new te);p(this,"scoreBoard",new le);p(this,"level",{newbie:40,low:30,middel:20,high:10});p(this,"currentLevel","newbie");this.rows.push(...t.map(e=>e instanceof O?e:new O(...e))),this.setLevel()}setLevel(t="newbie"){this.currentLevel=t}static randomSources(){const t=[1,2,3,4,5,6,7,8,9];return R.sorting(t)}static sorting(t){return t.sort(()=>parseInt((Math.random()*9).toString())%3==0?1:-1)}static randomize(t){console.log(123);const e=t.slice(3,6).concat(...t.slice(0,3)).concat(...t.slice(6,9));for(let l in e){for(let s in e[l])if(s%3===0){let i=e[l].tiles[s];e[l].tiles[s]=e[l*3+2],e[l*3+2]=i}e[l].tiles=e[l].tiles.slice(3,6).concat(...e[l].tiles.slice(0,3)).concat(...e[l].tiles.slice(6,9))}return e}initialize(t){const e=R.deepCopy(t);for(let l in this.rows)this.rows[l]=e.rows[l];g.number=null,g.place=null,n.selectTile=null,n.selected=null,d.number=null,d.place=null,d.count=0,this.level={newbie:40,low:30,middel:20,high:10}}fillRandoms(){const t=new Map([[1,9],[2,9],[3,9],[4,9],[5,9],[6,9],[7,9],[8,9],[9,9]]);console.log(123);let l=(()=>Array.from(t.entries()).filter(([i,c])=>c>0).map(([i])=>i))(),s=l[parseInt((Math.random()*l.length).toString())];for(let i=0;i<this.rows.length;i++)for(let c=0;c<this.rows[i].tiles.length;c++)if(!(this.rows[i].tiles[c]>0))if(this.totalCorrectInPlace(i,c,s))if(t.get(s)>0)this.rows[i].tiles[c]=new T(s,!0),t.set(s,t.get(s)-1);else continue;else continue;return this}getCorrectNumber(t,e){const l=[];for(let i=1;i<=9;i++)this.totalCorrectInPlace(t,e,i)&&l.push(i);const s=parseInt((Math.random()*l.length).toString());return l.splice(s)[0]}fillNumbers(t,e=!1){const l=this.currentLevel;let s=t||x;for(let i=0;i<this.rows.length;i++){i>0&&i%3===0&&(s=s.slice(4).concat(s.slice(0,4)));for(let c=0;c<this.rows[i].tiles.length;c++){const a=parseInt(Math.random()*(this.rows.length*this.rows[i].tiles.length))%2===0;this.rows[i].tiles[c]=new T(s[(c+i*3)%9],this.level[l]>0?!a:!0,this.level[l]>0?a:!1),this.level[l]>0&&(this.level[l]-=1)}}return e&&(this.rows=R.randomize(this.rows)),this}getBlock(t,e,l){const s=parseInt((t/3).toString()),i=parseInt((e/3).toString());return this.rows.slice(s*3,(s+1)*3).reduce((b,a)=>(b.tiles.push(...a.tiles.slice(i*3,(i+1)*3)),b),new O)}getColumn(t){return this.rows.reduce((e,l)=>(e.tiles.push(l.tiles[t]),e),new O)}isCorrectInRow(t,e){const l=this.rows[t].isFitNumber(e),s=R.substraction(this.rows[t]);return[l,s]}isCorrectInColumn(t,e){const l=this.getColumn(t),s=l.isFitNumber(e),i=R.substraction(l);return[s,i]}isCorrectInBlock(t,e,l){const s=this.getBlock(t,e),i=s.isFitNumber(l),c=R.substraction(s);return[i,c]}totalCorrectInPlace(t,e,l){const[s,i]=this.isCorrectInRow(t,l),[c,b]=this.isCorrectInColumn(e,l),[a,m]=this.isCorrectInBlock(t,e,l);return s&&c&&a}clearBoard(){o.clearRect(0,0,h.width,h.height)}render(){const t=h.width>=768?F:h.width<768&&h.width>=594?H:D,e=h.width/2-this.rows.length/2*u*t,l=h.height/2-this.rows[0].tiles.length/2*r*t,s=h.width/2-this.rows.length/2*u*t,i=h.height/2-this.rows[0].tiles.length/2*r*t,c=s+u*t*E*v,b=i+r*t*L*k;n.selected&&(o.fillStyle=j,o.fillRect(n.selected[0]*u*t+e,n.selected[1]*r*t+l,u*t,r*t),o.fillStyle=N),g.number&&g.place&&(o.fillStyle=U,o.fillRect(g.place[1]*u*t+e,g.place[0]*r*t+l,u*t,r*t),o.fillStyle=N),d.place&&(o.fillStyle=M,o.fillRect(s,Number(d.place[0])*r*t+h.height/2-this.rows[0].tiles.length/2*r*t,c-s,r*t),o.fillRect(Number(d.place[1])*u*t+h.width/2-this.rows.length/2*u*t,i,u*t,b-i),o.fillStyle=N);for(let a in this.rows){const m=this.rows[a];for(let w in m.tiles){const S=m.tiles[w];d.number&&m.tiles[w].number===d.number&&(o.fillStyle=M,o.fillRect(w*u*t+e,a*r*t+l,u*t,r*t),o.fillStyle=N),n.selected&&!this.rows[n.selected[1]].tiles[n.selected[0]].hide&&!m.tiles[w].hide&&n.selected&&m.tiles[w].number!==0&&m.tiles[w].number===this.rows[n.selected[1]].tiles[n.selected[0]].number&&(o.fillStyle=X,o.fillRect(w*u*t+e,a*r*t+l,u*t,r*t),o.fillStyle=N),w%3===0&&a%3===0&&o.strokeRect(parseInt(w/3)-1+e+w*u*t,parseInt(a/3)-1+l+a*r*t,u*t*3,r*t*3),o.strokeStyle=V,o.strokeRect(w*u*t+e,a*r*t+l,u*t,r*t),!S.hide&&S.number!==0&&(o.fillStyle=S.origin?N:Z,o.fillText(S.number,w*u*t+e+u*t/2,a*r*t+l+r*t/2+y/3),o.font=`${y}px bold`)}}this.validation(this)}validation(t){for(let[e,l]of W.entries())I.set(e,l);for(let e=0;e<t.rows.length;e++)for(let l=0;l<t.rows[e].tiles.length;l++)t.rows[e].tiles[l].number>0&&!t.rows[e].tiles[l].hide&&this.tileCountDown(t.rows[e].tiles[l].number)}tileCountDown(t){I.get(t)>0&&I.set(t,I.get(t)-1)}static deepCopy(t){return new R(...t.rows.map(e=>e.deepCopy()))}static substraction(t){return x.reduce((e,l)=>(t.isFitNumber(l)&&e.push(l),e),[])}}const P="고정 값은 변경할 수 없습니다.",z="잘못된 수";class se{constructor(){p(this,"sudoku",null);p(this,"newSudoku",null);p(this,"currentPoint",{x:0,y:0})}detect(t){this.currentPoint=t}render(t){this.sudoku=t;const e=h.width>=768?F:h.width<768&&h.width>=594?H:D,l=h.width*J,s=h.width/2-t.rows.length/2*u*e,i=h.height/2-t.rows[0].tiles.length/2*r*e,c=s+u*e*E*v,b=i+r*e*L*k,a=parseInt((this.currentPoint.x-s)/(c-s)*(E*v)),m=parseInt((this.currentPoint.y-i)/(b-i)*(L*k));s<this.currentPoint.x&&i<this.currentPoint.y&&c>this.currentPoint.x&&b>this.currentPoint.y&&((!n.tile||n.tile[0]!==a||n.tile[1]!==m)&&(n.tile=[a,m]),o.fillStyle=G,o.fillRect(Number(a)*u*e+h.width/2-t.rows.length/2*u*e,Number(m)*r*e+h.height/2-t.rows[0].tiles.length/2*r*e,u*e,r*e),o.fillRect(s,Number(m)*r*e+h.height/2-t.rows[0].tiles.length/2*r*e,c-s,r*e),o.fillRect(Number(a)*u*e+h.width/2-t.rows.length/2*u*e,i,u*e,b-i),o.fillStyle=N),c+l<this.currentPoint.x&&i<this.currentPoint.y&&c+l+u*e>this.currentPoint.x&&b>this.currentPoint.y?(n.selectTile=m,o.fillStyle=G,o.fillRect(c+l,Number(m)*r*e+h.height/2-t.rows[0].tiles.length/2*r*e,u*e,r*e),o.fillStyle=N):n.selectTile!==null&&(n.selectTile=null),c+l-u*e<this.currentPoint.x&&i<this.currentPoint.y&&c+l>this.currentPoint.x&&i+r*e>this.currentPoint.y?n.deletion||(n.deletion=!0):n.deletion=!1,s<this.currentPoint.x&&i<this.currentPoint.y&&c>this.currentPoint.x&&b>this.currentPoint.y||c+l<this.currentPoint.x&&i<this.currentPoint.y&&c+l+u*e>this.currentPoint.x&&b>this.currentPoint.y||c+l-u*e<this.currentPoint.x&&i<this.currentPoint.y&&c+l>this.currentPoint.x&&i+r*e>this.currentPoint.y?document.body.style.cursor="pointer":(document.body.style.cursor="inherit",n.tile&&(n.tile=null))}click(t){this.newSudoku=t;try{if(g.number&&(g.number=null,g.place=null),n.selectTile!==null){const[e,l]=n.selected,s=x[n.selectTile];this.sudoku.totalCorrectInPlace(l,e,s)||s===this.sudoku.rows[l].tiles[e]?this.sudoku.rows[l].tiles[e].origin?alert(P):(this.sudoku.rows[l].tiles[e].setNumber(s),n.selectTile=null,n.selected=null,d.number=null,d.place=null,g.number=s,g.place=[l,e]):this.sudoku.rows[l].tiles[e].origin?(d.number=s,d.place=[l,e],n.selectTile=null,alert(P),d.number=null,d.place=null):(console.log(this.sudoku.rows[l].tiles[e]),console.log(z),d.number=s,d.place=[l,e],n.selectTile=null,d.count+=1,d.count>=A&&(alert(`game over
 You lose!`),this.sudoku.initialize(t)))}if(n.tile?(n.selected=n.tile,d.number=null,d.place=null):n.selectTile&&(n.selected=null),n.selected&&n.deletion){const e=this.sudoku.rows[n.selected[1]].tiles[n.selected[0]];e.origin?alert(P):(e.deleteNumber(),n.deletion=!1,n.selected=null,n.selectTile=null,d.number=null,d.place=null)}}catch(e){console.log("에러 확인",e)}}keydown(t){if(t.match(/[1-9]/g)){n.selectTile=Number(t)-1;try{g.number&&(g.number=null,g.place=null);const[e,l]=n.selected,s=x[n.selectTile];this.sudoku.totalCorrectInPlace(l,e,s)||s===this.sudoku.rows[l].tiles[e]?this.sudoku.rows[l].tiles[e].origin?alert(P):(this.sudoku.rows[l].tiles[e].setNumber(s),n.selectTile=null,n.selected=null,d.number=null,d.place=null,g.number=s,g.place=[l,e]):this.sudoku.rows[l].tiles[e].origin?(d.number=s,d.place=[l,e],n.selectTile=null,alert(P)):(console.log(z),d.number=s,d.place=[l,e],n.selectTile=null,d.count+=1,d.count>=A&&(alert(`game over
 You lose!`),this.sudoku.initialize(this.newSudoku))),n.selectTile&&(n.selected=null),n.selected&&n.deletion&&(this.sudoku.rows[n.selected[1]].tiles[n.selected[0]].deleteNumber(),n.deletion=!1,n.selected=null,n.selectTile=null,d.number=null,d.place=null)}catch(e){console.log("에러 확인",e)}}else if(t==="Backspace"&&n.selected){const e=this.sudoku.rows[n.selected[1]].tiles[n.selected[0]];e.origin?alert(P):(e.deleteNumber(),n.deletion=!1,n.selected=null,n.selectTile=null,d.number=null,d.place=null)}}}ee.insertAdjacentElement("beforeend",h);const B={x:0,y:0},C=new R([0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]).fillNumbers(R.randomSources(),!0),_=new se,ie=R.deepCopy(C);function $(f){requestAnimationFrame($),C.clearBoard(),_.detect(B),_.render(C),C.render(),C.numberPad.render(C),C.scoreBoard.render(C)}requestAnimationFrame($);h.width=innerWidth;h.height=innerHeight;window.addEventListener("resize",f=>{h.width=innerWidth,h.height=innerHeight});window.addEventListener("mousemove",f=>{const t=f.clientX,e=f.clientY;B.x=t,B.y=e});window.addEventListener("keydown",f=>{const t=f.key;_.keydown(t)});window.addEventListener("click",f=>{_.click(ie)});
